<app-post-search (search)="onSearch($event)"></app-post-search>
<mat-accordion class="accordion">
    <mat-expansion-panel *ngFor="let post of pageData?.posts" >
        <mat-expansion-panel-header class="post-header">
            <mat-panel-title>{{post.title}}</mat-panel-title>
            <mat-panel-description>
                <mat-chip-list class="tags">
                    <mat-chip *ngFor="let tag of post.tags | slice:0:3">{{tag}}</mat-chip>   
                    <mat-chip *ngIf="post.tags.length > 3" >...</mat-chip>   
                </mat-chip-list>
            </mat-panel-description>
        </mat-expansion-panel-header>            
        
        <div class="post-content">{{post.content}}</div>

        <div *ngIf="post.documents.length > 0">
            <mat-divider class="divider"></mat-divider>
            <mat-list>
                <h3 mat-subheader>Attachments <mat-icon class="download-all" (click)="download(post.id)">cloud_download</mat-icon></h3>
                <mat-list-item *ngFor="let doc of post.documents" (click)="download(post.id, doc)">
                    <mat-icon mat-list-icon>attachment</mat-icon>
                    <h4 class="file-name" mat-line>{{doc.fileName}}</h4>
                </mat-list-item>
            </mat-list>
        </div>
        
        
        <mat-action-row *ngIf="isAuthenticated() && curUser && curUser.id == post.author">
            <button mat-button color="primary" [routerLink]="['/post/edit', post.id]" >Edit</button>
            <button mat-button color="warn" (click)="delete(post.id)">Delete</button>
        </mat-action-row>
    </mat-expansion-panel>
</mat-accordion>

<div *ngIf="pageData?.totalPosts > 0" class="pagination">
    <mat-paginator [length]="pageData?.totalPosts"
                [pageIndex]="pageIndex"
                [pageSize]="pageSize"
                [pageSizeOptions]="pageSizeOptions"
                (page)="onPageChange($event)">
    </mat-paginator>
</div>
